# =============================================================================
# HOST IP CONFIGURATION
# =============================================================================

# Determine your IP addresses automatically
HOST_IP=$(hostname -I | awk '{print $1}')
HOST_IP_EXTERNAL=$(hostname -I | awk '{print $1}')

# Alternative: Set manually based on your needs
# For local development only:
# HOST_IP=127.0.0.1
# HOST_IP_EXTERNAL=127.0.0.1

# For local network access (recommended):
# HOST_IP=192.168.1.131  # Your local IP
# HOST_IP_EXTERNAL=192.168.1.131

# For internet access (requires port forwarding):
# HOST_IP=192.168.1.131  # Your local IP
# HOST_IP_EXTERNAL=99.151.13.97  # Your public IP

# =============================================================================
# MODEL CONFIGURATION
# =============================================================================

CHATQNA_EMBEDDING_MODEL_ID="BAAI/bge-base-en-v1.5"
CHATQNA_HUGGINGFACEHUB_API_TOKEN="" # Replace with your actual HF token
CHATQNA_LLM_MODEL_ID="Qwen/Qwen2.5-7B-Instruct-1M"
CHATQNA_RERANK_MODEL_ID="BAAI/bge-reranker-base"

# =============================================================================
# PORT CONFIGURATION
# =============================================================================

CHATQNA_BACKEND_SERVICE_PORT=8890
CHATQNA_FRONTEND_SERVICE_PORT=5174
CHATQNA_NGINX_PORT=8081
CHATQNA_REDIS_DATAPREP_PORT=18104
CHATQNA_REDIS_RETRIEVER_PORT=7001
CHATQNA_REDIS_VECTOR_INSIGHT_PORT=8002
CHATQNA_REDIS_VECTOR_PORT=6380
CHATQNA_TEI_EMBEDDING_PORT=18091
CHATQNA_TEI_RERANKING_PORT=18809
CHATQNA_VLLM_SERVICE_PORT=18009

# =============================================================================
# SERVICE ENDPOINTS (External Access)
# =============================================================================

CHATQNA_BACKEND_SERVICE_ENDPOINT="http://${HOST_IP_EXTERNAL}:${CHATQNA_BACKEND_SERVICE_PORT}/v1/chatqna"
CHATQNA_BACKEND_SERVICE_IP=${HOST_IP}
CHATQNA_DATAPREP_DELETE_FILE_ENDPOINT="http://${HOST_IP_EXTERNAL}:${CHATQNA_REDIS_DATAPREP_PORT}/v1/dataprep/delete"
CHATQNA_DATAPREP_GET_FILE_ENDPOINT="http://${HOST_IP_EXTERNAL}:${CHATQNA_REDIS_DATAPREP_PORT}/v1/dataprep/get"
CHATQNA_DATAPREP_SERVICE_ENDPOINT="http://${HOST_IP_EXTERNAL}:${CHATQNA_REDIS_DATAPREP_PORT}/v1/dataprep/ingest"
CHATQNA_FRONTEND_SERVICE_IP=${HOST_IP}

# =============================================================================
# INTER-CONTAINER COMMUNICATION CONFIGURATION
# =============================================================================

# Retriever Service Configuration
RETRIEVER_SERVICE_HOST_IP=chatqna-retriever
RETRIEVER_SERVICE_PORT=7000

# vLLM Service Configuration
LLM_SERVER_HOST_IP=chatqna-vllm-service
LLM_SERVER_PORT=8011  # Internal port (NOT 18008)

# TEI (Text Embeddings Inference) Service Configuration
EMBEDDING_SERVER_HOST_IP=chatqna-tei-embedding-service
EMBEDDING_SERVER_PORT=80  # Internal port (NOT 18090)

# Reranking Service Configuration
RERANK_SERVER_HOST_IP=chatqna-tei-reranking-service
RERANK_SERVER_PORT=80  # Internal port (NOT 18808)

# LLM Model Configuration
LLM_MODEL=${CHATQNA_LLM_MODEL_ID}

# =============================================================================
# RETRIEVER-SPECIFIC ENVIRONMENT VARIABLES
# =============================================================================

TEI_EMBEDDING_ENDPOINT=http://chatqna-tei-embedding-service:80
HF_TOKEN=${CHATQNA_HUGGINGFACEHUB_API_TOKEN}
REDIS_URL=redis://chatqna-redis-vector-db:6379

# =============================================================================
# LEGACY VARIABLES (for backward compatibility)
# =============================================================================

CHATQNA_EMBEDDING_SERVICE_HOST_IP=${EMBEDDING_SERVER_HOST_IP}
CHATQNA_LLM_SERVICE_HOST_IP=${LLM_SERVER_HOST_IP}
CHATQNA_MEGA_SERVICE_HOST_IP=${HOST_IP}
CHATQNA_REDIS_URL=${REDIS_URL}
CHATQNA_RERANK_SERVICE_HOST_IP=${RERANK_SERVER_HOST_IP}
CHATQNA_RETRIEVER_SERVICE_HOST_IP=${RETRIEVER_SERVICE_HOST_IP}
CHATQNA_TEI_EMBEDDING_ENDPOINT=${TEI_EMBEDDING_ENDPOINT}

CHATQNA_BACKEND_SERVICE_NAME=chatqna
CHATQNA_INDEX_NAME="rag-redis"

# =============================================================================
# PROXY CONFIGURATION (if needed)
# =============================================================================

# Uncomment and set if you're behind a proxy
# http_proxy=http://your-proxy:port
# https_proxy=http://your-proxy:port
# no_proxy=localhost,127.0.0.1,${HOST_IP}

# =============================================================================
# DOCKER REGISTRY CONFIGURATION
# =============================================================================

REGISTRY=opea
TAG=latest
MODEL_CACHE=./data

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

LOGFLAG=INFO
